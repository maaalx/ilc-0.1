<?php  include("../db.php");
include("../includes/header.php"); ?>

 <section class="overlay overlay-green parallax"  data-stellar-background-ratio="0.5">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="inner-title">
                        <h2>Register</h2>
                        
                    </div>
                </div>
            </div>
        </div>
    </section>  
   
 <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  
   <section class="contact-1">
              <div class="container">
<br><br>
                  <div class="section-content">
                      <div class="row">
                         
                          <div class=" col-md-8">
		     				  
    <div class="login-box">
      <div class="login-logo">
        
	 <div class="login-box-body">
        
   

        <form action="index.php" method="post">
           <div class="register-box-body">
        <p class="login-box-msg">Register a new membership</p>
		<div style="color:red" id="check_user_text"></div>
        <form action="../../index.html" method="post">
          <div class="form-group has-feedback">
            <input type="text" class="form-control" name="first_name" id="first_name" placeholder="First name">
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
		  <div class="form-group has-feedback">
            <input type="text" class="form-control" name="last_name" id="last_name" placeholder="Last name">
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
		  <div class="form-group ">
					<div class="form-group">
                      <label>User Type</label>
                      <select onchange="return check_type(this.value)" name="user_type" id="user_type" class="form-control">
					  <option value='0'>Select</option>
					  <?php $query=mysqli_query($db,"select * from user_type where id!='5'");
						while($row=mysqli_fetch_assoc($query)){
							
						
					  ?>
                        <option value="<?php echo $row['id']; ?>"><?php echo $row['name']; ?></option>
                        
                        <?php } ?>
                      </select>
                    </div>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
		  
		  <div  style="display:none" class="form-group choose-doctor">
					<div class="form-group">
                      <label>Select Doctor</label>
                      <select name="doctor_id" id="doctor_id" class="form-control">
					  <option value='0'>Select Doctor</option>
					  <?php $temp_query=mysqli_query($db,"select * from users where user_type='3' order by fname,lname");
						while($row=mysqli_fetch_assoc($temp_query)){
						?>
                        <option value="<?php echo $row['user_id']; ?>"><?php echo $row['fname'].' '.$row['lname']; ?></option>
                        <?php } ?>
                      </select>
                    </div>
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
		  
          <div class="form-group has-feedback">
            <input type="email" name="user_email" id="user_email" class="form-control" placeholder="Email">
            <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            <input type="password" class="form-control" name="password" id="password" placeholder="Password">
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            <input type="password" class="form-control" id="confirm_password" name="confirm_password" placeholder="Retype password">
            <span class="glyphicon glyphicon-log-in form-control-feedback"></span>
          </div>
		  <div class="form-group">
		   <label>Date Of Birth</label>
            <div class="input-group">
                      <div class="input-group-addon">
                        <i class="fa fa-calendar"></i>
                      </div>
                      <input type="text" name="dob" id="dob" class="form-control" data-inputmask="'alias': 'yyyy-mm-dd'" data-mask>
                    </div><!-- /.input group -->
          </div>
		  <div class="form-group ">
					<div class="form-group">
                      <label>Security Question</label>
                      <select name="security_question" id="security_question" class="form-control">
                        <option value="" selected="selected">Please select...</option>
						<option value="Your mothers maiden name">Your mothers maiden name</option>
						<option value="Your first pets name">Your first pets name</option>
						<option value="The name of your elementary school">The name of your elementary school</option>
						<option value="Your elementary school mascot">Your elementary school mascot</option>
						<option value="Your best friends nickname">Your best friends nickname</option>
						<option value="Your favorite sports team">Your favorite sports team</option>
						<option value="Your favorite writer">Your favorite writer</option>
						<option value="Your favorite actor">Your favorite actor</option>
						<option value="Your favorite singer">Your favorite singer</option>
						<option value="Your favorite song">Your favorite song</option>
						<option value="The name of the street you grew up on">The name of the street you grew up on</option>
						<option value="Make and model of your first car">Make and model of your first car</option>
						<option value="The city where you first met your spouse">The city where you first met your spouse</option><option value="other">Other...</option>
                        
                      </select>
                    </div>
					<input type="text" class="form-control" name="security_answer" id="security_answer" placeholder="Security Answer">
            <span class="glyphicon glyphicon-user form-control-feedback"></span>
          </div>
          <div class="row">
            <div class="col-xs-8">
              <div class="checkbox icheck">
                <label>
                  <input type="checkbox"> I agree to the <a href="#">terms</a>
                </label>
              </div>
            </div><!-- /.col -->
            <div class="col-xs-4">
              <button type="submit" class="btn btn-primary btn-block btn-flat register">Register</button>
			 <div style="display:none" class="loading"> Saving<img src="img/loading.gif"></div>
            </div><!-- /.col -->
          </div>
        </form>


        <a href="<?php echo SITEROOT; ?>/login.php" class="text-center">I already have a membership</a>
      </div><!-- /.form-box -->
        </form>
<br><br>
        </div><!-- /.login-box-body -->
    </div><!-- /.login-box -->
	
</div>
</div>
</div>
</div>
</div>
	

    <!-- jQuery 2.1.4 -->
    <script src="plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- iCheck -->
    <script src="plugins/iCheck/icheck.min.js"></script>
	
	 <!-- Select2 -->
    <script src="plugins/select2/select2.full.min.js"></script>
	 <!-- InputMask -->
    <script src="plugins/input-mask/jquery.inputmask.js"></script>
    <script src="plugins/input-mask/jquery.inputmask.date.extensions.js"></script>
    <script src="plugins/input-mask/jquery.inputmask.extensions.js"></script>
    <!-- date-range-picker -->
	
    <script type="text/javascript">
     function check_type(type_id){
		 if(type_id==2){
			 $(".choose-doctor").show();
		 }else{
			 $(".choose-doctor").hide();
		 }
	 }
      
	  function validateEmail(email) {
		var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(email);
	}
      $(document).ready(function(){
		$(".register").click(function(){  
					if($( "#first_name" ).val()==''){
						alert ("First name is required."); 
						$("#first_name").focus();
						return false;
					}
					if($( "#last_name" ).val()==''){
						alert ("Last name is required."); 
						$("#last_name").focus();
						return false;
					}
					if($( "#user_email" ).val()==''){
						alert ("Email is required."); 
						$("#user_email").focus();
						return false;
					}
					if (!validateEmail($( "#user_email" ).val())) {
						$("#user_email").focus();
						alert("Please enter valid email address");
						return false;
					}

					if($( "#password" ).val()==''){
						alert ("Password is required.");
						$("#password").focus();
						return false;
					}
					
					var numric_str=0;
					var upper_str=0;
					var i=0;
					var character='';
					var pass_tr=$( "#password" ).val();

						while (i <= pass_tr.length){
							character = pass_tr.charAt(i);
							if (!isNaN(character * 1)){
								numric_str=1;
							}else{
								if (character == character.toUpperCase()) {
									upper_str=1;
								}
								if (character == character.toLowerCase()){
									//alert ('lower case true');
								}
							}
							i++;
						}
					var matches = pass_tr.match(/\d+/g);
					if (matches != null) {
						
					}else{
						alert("Password must contain at least one interger value");
						$("#password").focus();
						return false;
					}	
					

					if(upper_str==0){
						alert("Password must contain at least one upper case letter");
						$("#password").focus();
						return false;
					}	

					if(pass_tr.length<8){
						alert("Password requires minimum 8 characters");
						$("#password").focus();
						return false;
					}	
					
					if($( "#password" ).val()!=$( "#confirm_password" ).val()){
						alert ("Password and confirm password should be same.");
						$("#confirm_password").focus();
						return false;
					}
				  
				  var dataString = '?fname='+ $("#first_name").val() + '&lname=' + $("#last_name").val()+ '&user_type=' + $("#user_type").val()+ '&user_email=' + $("#user_email").val()+ '&password=' + $("#password").val()+ '&dob=' + $("#dob").val()+ '&security_question=' + $("#security_question").val()+ '&security_answer=' + $("#security_answer").val()+'&doctor_id=' + $("#doctor_id").val();
				  
				  $(".loading").show();
				  $.ajax({url: "save-register.php"+dataString, success: function(result){
					   $(".loading").hide();
					  if (result==1){
							alert("Successfully Registered. We have sent you account activate link on your email address.");
						    window.location="../login.php";
					  } else{
						$("#check_user_text").text("Something went wrong. Please try again");
						alert("Something went wrong. Please try again");
					  }
				  }});
				  
                        return false;
		});                   
      });
    </script>
	
	 <script>
      $(function () {
        //Initialize Select2 Elements
        $(".select2").select2();

        //Datemask dd/mm/yyyy
        $("#datemask").inputmask("dd/mm/yyyy", {"placeholder": "dd/mm/yyyy"});
        //Datemask2 mm/dd/yyyy
        $("#datemask2").inputmask("mm/dd/yyyy", {"placeholder": "mm/dd/yyyy"});
        //Money Euro
        $("[data-mask]").inputmask();

        
      });
    </script>
 <?php include("../includes/footer.php"); ?>
